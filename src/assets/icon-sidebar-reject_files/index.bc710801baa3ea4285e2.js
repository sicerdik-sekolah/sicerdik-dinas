(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1028:function(e,t,r){"use strict";r(767)},1029:function(e,t,r){var o=r(4)((function(i){return i[1]}));o.push([e.i,'@keyframes spin-746e931e{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.request-page[data-v-746e931e]{padding:32px 24px}h1[data-v-746e931e]{margin-bottom:16px}.request-placeholders[data-v-746e931e]{position:relative;overflow:hidden}.request-placeholders[data-v-746e931e]:after{content:"";position:absolute;bottom:0;left:0;right:0;height:70%;background:linear-gradient(0deg,#fff,hsla(0,0%,100%,0))}.request-list[data-v-746e931e]{min-height:300px}.request-list[data-v-746e931e] .infinite-scroller .preloader{height:120px}.request-list[data-v-746e931e] .post+.post{margin-top:40px}.empty[data-v-746e931e]{height:500px;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.empty .empty-icon[data-v-746e931e]{width:58px;height:58px;margin:0 auto 16px}.empty .empty-icon[data-v-746e931e] svg{display:block}.empty .empty-title[data-v-746e931e]{margin-bottom:8px;font-weight:600}.empty .empty-detail[data-v-746e931e]{max-width:360px}',""]),o.locals={},e.exports=o},1457:function(e,t,r){"use strict";r.r(t);var o=r(7),n=r(12),h=r(646),l=(r(47),{name:"RequestIconSearchPage",components:{requestSearch:()=>r.e(84).then(r.bind(null,1479)),requestForm:()=>r.e(76).then(r.bind(null,1480)),requestPost:()=>r.e(69).then(r.bind(null,1481)),requestPlaceholder:()=>r.e(82).then(r.bind(null,1482)),appInfiniteScroll:()=>r.e(2).then(r.bind(null,1483))},layout:"request-icon",data:()=>({initialUser:!1,page:1,makersIsLoading:!1,pages:1,limit:15,query:"",sortBy:"-createdAt",filterBy:"all",total:0,initialEmpty:!1,searchNotfound:!1,loading:!1,loadingMore:!1,posts:[]}),computed:{...Object(o.c)("request-icons",["getSorting"]),...Object(o.e)({user:e=>e.auth.user,platforms:e=>e.appInfo.platforms,makers:e=>e["request-icons"].makers}),requestedPlatforms(){const e=["ultraviolet","dusk","Dusk_Wired","cotton","pastel_glyph","win10","win8","android"],t={};return Object.keys(this.platforms).map((r=>{e.includes(r)||(t[r]=this.platforms[r])})),t},makersList(){return this.makers&&this.makers.docs?this.getSorting():(this.fetchMakers(),[])}},watch:{user(e){!this.posts.length||e.isGuest||this.initialUser&&e.loaded||(this.page=1,this.posts=[],this.fetchRequests(),this.fetchMakers())},query(e){if(0===e.length)return this.page=1,this.posts=[],void this.fetchRequests();this.searchHandler()}},async asyncData(e){let{route:t,store:r,env:o,query:n,req:l,redirect:c,error:d}=e,m=0,f=[],y=1;const k=r.state["request-icons"].makers;let v=!1,w=r.state.auth.user.authToken;try{const e=await h.a.fetchRequests({sort:"-createdAt",authToken:w,limit:15});if(f=e.docs,m=e.total,y=e.pages,f.length||(v=!0),w&&!k)try{const e={authToken:w,limit:10,page:1},t=await h.a.fetchMakers(e);r.commit("request-icons/SET_MAKERS",t)}catch(e){}}catch(e){console.error(e)}return r.dispatch("updateSEO",{title:"Request an icon | Icons8",description:"Request icons in your favourite style. Help us make our iconic world a better place."}),{total:m,pages:y,limit:15,posts:f,initialEmpty:v,initialUser:!1}},mounted(){window.addEventListener("load",this.notify),this.searchHandler=Object(n.debounce)((()=>{this.search()}),500)},beforeDestroy(){window.removeEventListener("load",this.notify)},methods:{...Object(o.d)("request-icons",{setMakers:"SET_MAKERS"}),notify(){void 0===localStorage.requestFirstVisit&&this.$notify({icon:this.$icons["request/thumbsUp"],title:"You can vote for the icons",text:"The requested icons with the most votes we draw first",delay:0,onCloseHandler(){localStorage.requestFirstVisit=Date.now()}})},loadMore(){!this.loadingMore&&this.page<this.pages&&(this.page+=1,this.fetchRequests())},fetchRequests(){if(this.loading||this.loadingMore)return;this.searchNotfound=!1;const e={sort:this.sortBy,page:this.page,limit:this.limit,term:this.query,authToken:this.user.authToken};"object"==typeof this.filterBy&&Object.assign(e,this.filterBy),1===this.page&&(this.loading=!0),this.page>1&&(this.loadingMore=!0),h.a.fetchRequests(e).then((e=>{this.total=e.total,this.pages=e.pages,this.$nextTick((()=>{this.posts=[...this.posts,...e.docs]})),this.posts.length||(this.searchNotfound=!0)})).catch((e=>console.warn(e))).finally((()=>{this.loading=!1,this.loadingMore=!1}))},fetchMakers(){if(!this.makers||!this.makers.docs)return[];this.makers.page<this.makers.pages?(this.makersIsLoading=!0,h.a.fetchMakers({authToken:this.user.authToken,limit:10,page:++this.makers.page}).then((e=>{this.setMakers(e),this.makersIsLoading=!1})).catch((()=>{this.makersIsLoading=!1}))):h.a.fetchMakers({authToken:this.user.authToken,limit:10,page:1}).then((e=>{this.setMakers(e),this.makersIsLoading=!1})).catch((()=>{this.makersIsLoading=!1}))},updateVotes(e,t){t.votesCount=e},requestAdd(data){this.pages>1&&this.pages>this.page&&this.posts.pop(),this.posts.unshift(data)},search(){this.page=1,this.posts=[],this.sortBy="-createdAt",this.filterBy="all",this.fetchRequests()},sort(param){this.sortBy=param,this.page=1,this.posts=[],this.fetchRequests()},filter(param){this.page=1,this.posts=[],this.filterBy=param,this.fetchRequests()}}}),c=(r(1028),r(3)),component=Object(c.a)(l,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"request-page"},[t("div",{staticClass:"container"},[t("h1",[e._v("Icon Request")]),e._v(" "),t("request-form",{attrs:{styles:e.requestedPlatforms,user:e.user},on:{"request:create":e.requestAdd}}),e._v(" "),e.initialEmpty?e._e():t("request-search",{attrs:{user:e.user,makers:e.makersList},on:{"request:sort":e.sort,"request:filter":e.filter},model:{value:e.query,callback:function(t){e.query="string"==typeof t?t.trim():t},expression:"query"}}),e._v(" "),t("div",{staticClass:"request-list"},[e.loading?[t("div",{staticClass:"request-placeholders"},e._l(5,(function(i){return t("request-placeholder",{key:i,attrs:{width:400,height:80}},[t("rect",{attrs:{x:"75",y:"20",rx:"4",ry:"4",width:"250",height:"8"}}),e._v(" "),t("rect",{attrs:{x:"75",y:"35",rx:"4",ry:"4",width:"220",height:"8"}}),e._v(" "),t("rect",{attrs:{x:"75",y:"50",rx:"4",ry:"4",width:"280",height:"8"}}),e._v(" "),t("rect",{attrs:{x:"75",y:"0",rx:"6",ry:"6",width:"320",height:"12"}}),e._v(" "),t("rect",{attrs:{x:"0",y:"0",rx:"6",ry:"6",width:"60",height:"65"}})])})),1)]:e.posts.length?[t("app-infinite-scroll",{attrs:{throttle:50,preloader:e.loadingMore},on:{infinite:e.loadMore}},e._l(e.posts,(function(r,o){return t("request-post",{key:o,attrs:{post:r,user:e.user,makers:e.makersList,"makers-is-loading":e.makersIsLoading,platforms:e.platforms},on:{"update:votes":function(t){return e.updateVotes(t,r)},"request:infiniteScroll":e.fetchMakers}})})),1)]:e.searchNotfound?[t("div",{staticClass:"empty"},[t("div",{staticClass:"empty-icon",domProps:{innerHTML:e._s(e.$icons["request/requestSad"])}}),e._v(" "),t("div",{staticClass:"empty-title"},[e._v("\n            No requests found\n          ")])])]:e.initialEmpty?[t("div",{staticClass:"empty"},[t("div",{staticClass:"empty-icon",domProps:{innerHTML:e._s(e.$icons["request/requestEmpty"])}}),e._v(" "),t("div",{staticClass:"empty-title"},[e._v("\n            There are no requests\n          ")]),e._v(" "),t("div",{staticClass:"empty-detail"},[e._v("\n            Here you can request icons that you haven't found. By the way, your request will be the first.\n          ")])])]:e._e()],2)],1)])}),[],!1,null,"746e931e",null);t.default=component.exports},646:function(e,t,r){"use strict";r.d(t,"b",(function(){return h}));var o=r(16);const n=r.n(o).a.create({baseURL:"https://inceptum.icons8.com"}),h=15;t.a={createRequest(e){let{title:title,description:t,attachments:r=[],platforms:o=[],authToken:h,isAnimated:l}=e;const data={title:title,description:t,attachments:r,platforms:o,isAnimated:l};let c;return h&&(c={Authorization:`Bearer ${h}`}),new Promise(((e,t)=>{n.request({url:"/api/requests",method:"put",data:data,headers:c}).then((t=>{t.data.success&&e(t.data)})).catch(t)}))},fetchRequests(e){let{sort:t,page:r=1,limit:o=h,isMine:l=!1,isAssignedToMe:c=!1,isUnassigned:d=null,isAssignedTo:m=null,status:f=null,term:y=null,authToken:k}=e;const v={sort:t,page:r,limit:o,type:"icon"};let w;return l&&(v.isMine=l),c&&(v.isAssignedToMe=c),d&&(v.isUnassigned=d),m&&(v.isAssignedTo=m),f&&(v.status=f),y&&(v.term=y),k&&(w={Authorization:`Bearer ${k}`}),new Promise(((e,t)=>{n.request({url:"/api/requests",method:"get",params:v,headers:w}).then((t=>{t.data.success&&e(t.data)})).catch(t)}))},fetchMakers(e){let t;return e.authToken&&(t={Authorization:`Bearer ${e.authToken}`}),new Promise(((r,o)=>{n.request({url:"/api/makers",method:"get",params:{limit:100,page:e.page},headers:t}).then((e=>{e.data.success&&r(e.data)})).catch(o)}))},fetchDetail(e){let t,{id:r,authToken:o}=e;return o&&(t={Authorization:`Bearer ${o}`}),new Promise(((e,o)=>{n.request({url:`/api/requests/${r}`,method:"get",headers:t}).then((t=>{t.data.success&&e(t.data)})).catch(o)}))},togglevote(e){let t,{action:r,id:o,authToken:h}=e;return h&&(t={Authorization:`Bearer ${h}`}),new Promise(((e,h)=>{n.request({url:`/api/requests/${o}/${r}`,method:"post",headers:t}).then((t=>{t.data.success&&e(t.data)})).catch(h)}))},assignMaker(e){let t,{id:r,makerId:o,authToken:h}=e;return h&&(t={Authorization:`Bearer ${h}`}),new Promise(((e,h)=>{n.request({url:`/api/requests/${r}/assignMaker`,method:"post",headers:t,data:{makerId:o}}).then((t=>{t.data.success&&e(t.data)})).catch(h)}))},takeToWork(e){let t,{id:r,authToken:o}=e;return o&&(t={Authorization:`Bearer ${o}`}),new Promise(((e,o)=>{n.request({url:`/api/requests/${r}/takeToWork`,method:"post",headers:t}).then((t=>{t.data.success&&e(t.data)})).catch(o)}))},deleteRequest(e){let t,{id:r,authToken:o}=e;return o&&(t={Authorization:`Bearer ${o}`}),new Promise(((e,o)=>{n.request({url:`/api/requests/${r}`,method:"delete",headers:t}).then((t=>{t.data.success&&e(t.data)})).catch(o)}))},resolveRequest(e){let t,{resolvedItems:r,id:o,authToken:h}=e;return h&&(t={Authorization:`Bearer ${h}`}),new Promise(((e,h)=>{n.request({url:`/api/requests/${o}/resolve`,method:"post",headers:t,data:{resolvedItems:r}}).then((t=>{t.data.success&&e(t.data)})).catch(h)}))},uploadFiles(e){let{file:t,authToken:r}=e,o={"Content-Type":"multipart/form-data"};r&&(o.Authorization=`Bearer ${r}`);const h=new FormData;return h.append("file",t,t.name),new Promise(((e,t)=>{n.request({url:"/api/uploadFiles",method:"post",headers:o,data:h}).then((t=>{t.data.success&&e(t.data)})).catch(t)}))}}},767:function(e,t,r){var content=r(1029);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(5).default)("9752a79c",content,!0,{sourceMap:!1})}}]);
//# sourceMappingURL=index.bc710801baa3ea4285e2.js.map